/*!
 * Copyright 2019 acrazing <joking.young@gmail.com>. All rights reserved.
 * @since 2019-12-18 12:08:04
 */

import { decode, encode } from 'msgpack-lite';
import { assertIs } from '../assert';
import { ArbitraryCodec } from './arbitrary';

export const msgpackCodec: ArbitraryCodec = {
  contentType: ['application/msgpack'],
  responseType: 'arrayBuffer',
  encode(data: any) {
    return encode(data);
  },
  decode(payload: Uint8Array | string) {
    assertIs(payload, Uint8Array);
    return decode(payload);
  },
};
